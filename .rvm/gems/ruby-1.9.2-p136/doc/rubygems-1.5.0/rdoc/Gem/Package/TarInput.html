<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Class: Gem::Package::TarInput</title>

	<link rel="stylesheet" href="../../rdoc.css" type="text/css" media="screen" />

	<script src="../../js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="class">

	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../../index.html">Home</a>
          <a href="../../index.html#classes">Classes</a>
          <a href="../../index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="../../lib/rubygems/package/tar_input_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/rubygems/package/tar_input.rb">lib/rubygems/package/tar_input.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			
			<div id="parent-class-section" class="section">
				<h3 class="section-header">Parent</h3>
				
				<p class="link"><a href="../../Object.html">Object</a></p>
				
			</div>
			

			<!-- Namespace Contents -->
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#method-c-new">::new</a></li>
					
					<li><a href="#method-c-open">::open</a></li>
					
					<li><a href="#method-i-close">#close</a></li>
					
					<li><a href="#method-i-each">#each</a></li>
					
					<li><a href="#method-i-extract_entry">#extract_entry</a></li>
					
					<li><a href="#method-i-load_gemspec">#load_gemspec</a></li>
					
					<li><a href="#method-i-zipped_stream">#zipped_stream</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
			<div id="includes-section" class="section">
				<h3 class="section-header">Included Modules</h3>
				<ul class="link-list">
				
				
					<li><a class="include" href="FSyncDir.html">Gem::Package::FSyncDir</a></li>
				
				
				
					<li><span class="include">Enumerable</span></li>
				
				
				</ul>
			</div>
			
		</div>

		<div id="project-metadata">
			
			
			<div id="fileindex-section" class="section project-section">
				<h3 class="section-header">Files</h3>
				<ul>
				
					<li class="file"><a href="../../GPL_txt.html">GPL.txt</a></li>
				
					<li class="file"><a href="../../History_txt.html">History.txt</a></li>
				
					<li class="file"><a href="../../LICENSE_txt.html">LICENSE.txt</a></li>
				
					<li class="file"><a href="../../README_rdoc.html">README.rdoc</a></li>
				
					<li class="file"><a href="../../UPGRADING_rdoc.html">UPGRADING.rdoc</a></li>
				
				</ul>
			</div>
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="../../images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="../../Gem.html">Gem</a></li>
				
					<li><a href="../../Gem/Builder.html">Gem::Builder</a></li>
				
					<li><a href="../../Gem/Command.html">Gem::Command</a></li>
				
					<li><a href="../../Gem/CommandLineError.html">Gem::CommandLineError</a></li>
				
					<li><a href="../../Gem/CommandManager.html">Gem::CommandManager</a></li>
				
					<li><a href="../../Gem/Commands.html">Gem::Commands</a></li>
				
					<li><a href="../../Gem/Commands/BuildCommand.html">Gem::Commands::BuildCommand</a></li>
				
					<li><a href="../../Gem/Commands/CertCommand.html">Gem::Commands::CertCommand</a></li>
				
					<li><a href="../../Gem/Commands/CheckCommand.html">Gem::Commands::CheckCommand</a></li>
				
					<li><a href="../../Gem/Commands/CleanupCommand.html">Gem::Commands::CleanupCommand</a></li>
				
					<li><a href="../../Gem/Commands/ContentsCommand.html">Gem::Commands::ContentsCommand</a></li>
				
					<li><a href="../../Gem/Commands/DependencyCommand.html">Gem::Commands::DependencyCommand</a></li>
				
					<li><a href="../../Gem/Commands/EnvironmentCommand.html">Gem::Commands::EnvironmentCommand</a></li>
				
					<li><a href="../../Gem/Commands/FetchCommand.html">Gem::Commands::FetchCommand</a></li>
				
					<li><a href="../../Gem/Commands/GenerateIndexCommand.html">Gem::Commands::GenerateIndexCommand</a></li>
				
					<li><a href="../../Gem/Commands/HelpCommand.html">Gem::Commands::HelpCommand</a></li>
				
					<li><a href="../../Gem/Commands/InstallCommand.html">Gem::Commands::InstallCommand</a></li>
				
					<li><a href="../../Gem/Commands/ListCommand.html">Gem::Commands::ListCommand</a></li>
				
					<li><a href="../../Gem/Commands/LockCommand.html">Gem::Commands::LockCommand</a></li>
				
					<li><a href="../../Gem/Commands/OutdatedCommand.html">Gem::Commands::OutdatedCommand</a></li>
				
					<li><a href="../../Gem/Commands/OwnerCommand.html">Gem::Commands::OwnerCommand</a></li>
				
					<li><a href="../../Gem/Commands/PristineCommand.html">Gem::Commands::PristineCommand</a></li>
				
					<li><a href="../../Gem/Commands/PushCommand.html">Gem::Commands::PushCommand</a></li>
				
					<li><a href="../../Gem/Commands/QueryCommand.html">Gem::Commands::QueryCommand</a></li>
				
					<li><a href="../../Gem/Commands/RdocCommand.html">Gem::Commands::RdocCommand</a></li>
				
					<li><a href="../../Gem/Commands/SearchCommand.html">Gem::Commands::SearchCommand</a></li>
				
					<li><a href="../../Gem/Commands/ServerCommand.html">Gem::Commands::ServerCommand</a></li>
				
					<li><a href="../../Gem/Commands/SetupCommand.html">Gem::Commands::SetupCommand</a></li>
				
					<li><a href="../../Gem/Commands/SourcesCommand.html">Gem::Commands::SourcesCommand</a></li>
				
					<li><a href="../../Gem/Commands/SpecificationCommand.html">Gem::Commands::SpecificationCommand</a></li>
				
					<li><a href="../../Gem/Commands/StaleCommand.html">Gem::Commands::StaleCommand</a></li>
				
					<li><a href="../../Gem/Commands/UninstallCommand.html">Gem::Commands::UninstallCommand</a></li>
				
					<li><a href="../../Gem/Commands/UnpackCommand.html">Gem::Commands::UnpackCommand</a></li>
				
					<li><a href="../../Gem/Commands/UpdateCommand.html">Gem::Commands::UpdateCommand</a></li>
				
					<li><a href="../../Gem/Commands/WhichCommand.html">Gem::Commands::WhichCommand</a></li>
				
					<li><a href="../../Gem/ConfigFile.html">Gem::ConfigFile</a></li>
				
					<li><a href="../../Gem/ConsoleUI.html">Gem::ConsoleUI</a></li>
				
					<li><a href="../../Gem/DefaultUserInteraction.html">Gem::DefaultUserInteraction</a></li>
				
					<li><a href="../../Gem/Dependency.html">Gem::Dependency</a></li>
				
					<li><a href="../../Gem/DependencyError.html">Gem::DependencyError</a></li>
				
					<li><a href="../../Gem/DependencyInstaller.html">Gem::DependencyInstaller</a></li>
				
					<li><a href="../../Gem/DependencyList.html">Gem::DependencyList</a></li>
				
					<li><a href="../../Gem/DependencyRemovalException.html">Gem::DependencyRemovalException</a></li>
				
					<li><a href="../../Gem/DocManager.html">Gem::DocManager</a></li>
				
					<li><a href="../../Gem/DocumentError.html">Gem::DocumentError</a></li>
				
					<li><a href="../../Gem/EndOfYAMLException.html">Gem::EndOfYAMLException</a></li>
				
					<li><a href="../../Gem/ErrorReason.html">Gem::ErrorReason</a></li>
				
					<li><a href="../../Gem/Exception.html">Gem::Exception</a></li>
				
					<li><a href="../../Gem/Ext.html">Gem::Ext</a></li>
				
					<li><a href="../../Gem/Ext/Builder.html">Gem::Ext::Builder</a></li>
				
					<li><a href="../../Gem/Ext/ConfigureBuilder.html">Gem::Ext::ConfigureBuilder</a></li>
				
					<li><a href="../../Gem/Ext/ExtConfBuilder.html">Gem::Ext::ExtConfBuilder</a></li>
				
					<li><a href="../../Gem/Ext/RakeBuilder.html">Gem::Ext::RakeBuilder</a></li>
				
					<li><a href="../../Gem/FakeFetcher.html">Gem::FakeFetcher</a></li>
				
					<li><a href="../../Gem/FileOperations.html">Gem::FileOperations</a></li>
				
					<li><a href="../../Gem/FilePermissionError.html">Gem::FilePermissionError</a></li>
				
					<li><a href="../../Gem/Format.html">Gem::Format</a></li>
				
					<li><a href="../../Gem/FormatException.html">Gem::FormatException</a></li>
				
					<li><a href="../../Gem/GemNotFoundException.html">Gem::GemNotFoundException</a></li>
				
					<li><a href="../../Gem/GemNotInHomeException.html">Gem::GemNotInHomeException</a></li>
				
					<li><a href="../../Gem/GemPathSearcher.html">Gem::GemPathSearcher</a></li>
				
					<li><a href="../../Gem/GemRunner.html">Gem::GemRunner</a></li>
				
					<li><a href="../../Gem/GemcutterUtilities.html">Gem::GemcutterUtilities</a></li>
				
					<li><a href="../../Gem/Indexer.html">Gem::Indexer</a></li>
				
					<li><a href="../../Gem/InstallError.html">Gem::InstallError</a></li>
				
					<li><a href="../../Gem/InstallUpdateOptions.html">Gem::InstallUpdateOptions</a></li>
				
					<li><a href="../../Gem/Installer.html">Gem::Installer</a></li>
				
					<li><a href="../../Gem/Installer/ExtensionBuildError.html">Gem::Installer::ExtensionBuildError</a></li>
				
					<li><a href="../../Gem/InstallerTestCase.html">Gem::InstallerTestCase</a></li>
				
					<li><a href="../../Gem/InvalidSpecificationException.html">Gem::InvalidSpecificationException</a></li>
				
					<li><a href="../../Gem/LoadError.html">Gem::LoadError</a></li>
				
					<li><a href="../../Gem/LocalRemoteOptions.html">Gem::LocalRemoteOptions</a></li>
				
					<li><a href="../../Gem/MockGemUi.html">Gem::MockGemUi</a></li>
				
					<li><a href="../../Gem/MockGemUi/TTY.html">Gem::MockGemUi::TTY</a></li>
				
					<li><a href="../../Gem/MockGemUi/TermError.html">Gem::MockGemUi::TermError</a></li>
				
					<li><a href="../../Gem/OldFormat.html">Gem::OldFormat</a></li>
				
					<li><a href="../../Gem/OperationNotSupportedError.html">Gem::OperationNotSupportedError</a></li>
				
					<li><a href="../../Gem/Package.html">Gem::Package</a></li>
				
					<li><a href="../../Gem/Package/BadCheckSum.html">Gem::Package::BadCheckSum</a></li>
				
					<li><a href="../../Gem/Package/ClosedIO.html">Gem::Package::ClosedIO</a></li>
				
					<li><a href="../../Gem/Package/Error.html">Gem::Package::Error</a></li>
				
					<li><a href="../../Gem/Package/FSyncDir.html">Gem::Package::FSyncDir</a></li>
				
					<li><a href="../../Gem/Package/FormatError.html">Gem::Package::FormatError</a></li>
				
					<li><a href="../../Gem/Package/NonSeekableIO.html">Gem::Package::NonSeekableIO</a></li>
				
					<li><a href="../../Gem/Package/TarHeader.html">Gem::Package::TarHeader</a></li>
				
					<li><a href="../../Gem/Package/TarInput.html">Gem::Package::TarInput</a></li>
				
					<li><a href="../../Gem/Package/TarInvalidError.html">Gem::Package::TarInvalidError</a></li>
				
					<li><a href="../../Gem/Package/TarOutput.html">Gem::Package::TarOutput</a></li>
				
					<li><a href="../../Gem/Package/TarReader.html">Gem::Package::TarReader</a></li>
				
					<li><a href="../../Gem/Package/TarReader/Entry.html">Gem::Package::TarReader::Entry</a></li>
				
					<li><a href="../../Gem/Package/TarReader/UnexpectedEOF.html">Gem::Package::TarReader::UnexpectedEOF</a></li>
				
					<li><a href="../../Gem/Package/TarTestCase.html">Gem::Package::TarTestCase</a></li>
				
					<li><a href="../../Gem/Package/TarWriter.html">Gem::Package::TarWriter</a></li>
				
					<li><a href="../../Gem/Package/TarWriter/BoundedStream.html">Gem::Package::TarWriter::BoundedStream</a></li>
				
					<li><a href="../../Gem/Package/TarWriter/FileOverflow.html">Gem::Package::TarWriter::FileOverflow</a></li>
				
					<li><a href="../../Gem/Package/TarWriter/RestrictedStream.html">Gem::Package::TarWriter::RestrictedStream</a></li>
				
					<li><a href="../../Gem/Package/TooLongFileName.html">Gem::Package::TooLongFileName</a></li>
				
					<li><a href="../../Gem/PackageTask.html">Gem::PackageTask</a></li>
				
					<li><a href="../../Gem/Platform.html">Gem::Platform</a></li>
				
					<li><a href="../../Gem/PlatformMismatch.html">Gem::PlatformMismatch</a></li>
				
					<li><a href="../../Gem/RemoteError.html">Gem::RemoteError</a></li>
				
					<li><a href="../../Gem/RemoteFetcher.html">Gem::RemoteFetcher</a></li>
				
					<li><a href="../../Gem/RemoteFetcher/FetchError.html">Gem::RemoteFetcher::FetchError</a></li>
				
					<li><a href="../../Gem/RemoteInstallationCancelled.html">Gem::RemoteInstallationCancelled</a></li>
				
					<li><a href="../../Gem/RemoteInstallationSkipped.html">Gem::RemoteInstallationSkipped</a></li>
				
					<li><a href="../../Gem/RemoteSourceException.html">Gem::RemoteSourceException</a></li>
				
					<li><a href="../../Gem/RequirePathsBuilder.html">Gem::RequirePathsBuilder</a></li>
				
					<li><a href="../../Gem/Requirement.html">Gem::Requirement</a></li>
				
					<li><a href="../../Gem/Security/Exception.html">Gem::Security::Exception</a></li>
				
					<li><a href="../../Gem/Security/Signer.html">Gem::Security::Signer</a></li>
				
					<li><a href="../../Gem/Server.html">Gem::Server</a></li>
				
					<li><a href="../../Gem/SilentUI.html">Gem::SilentUI</a></li>
				
					<li><a href="../../Gem/SourceIndex.html">Gem::SourceIndex</a></li>
				
					<li><a href="../../Gem/SpecFetcher.html">Gem::SpecFetcher</a></li>
				
					<li><a href="../../Gem/Specification.html">Gem::Specification</a></li>
				
					<li><a href="../../Gem/StreamUI.html">Gem::StreamUI</a></li>
				
					<li><a href="../../Gem/StreamUI/SilentDownloadReporter.html">Gem::StreamUI::SilentDownloadReporter</a></li>
				
					<li><a href="../../Gem/StreamUI/SilentProgressReporter.html">Gem::StreamUI::SilentProgressReporter</a></li>
				
					<li><a href="../../Gem/StreamUI/SimpleProgressReporter.html">Gem::StreamUI::SimpleProgressReporter</a></li>
				
					<li><a href="../../Gem/StreamUI/VerboseDownloadReporter.html">Gem::StreamUI::VerboseDownloadReporter</a></li>
				
					<li><a href="../../Gem/StreamUI/VerboseProgressReporter.html">Gem::StreamUI::VerboseProgressReporter</a></li>
				
					<li><a href="../../Gem/SystemExitException.html">Gem::SystemExitException</a></li>
				
					<li><a href="../../Gem/TestCase.html">Gem::TestCase</a></li>
				
					<li><a href="../../Gem/Text.html">Gem::Text</a></li>
				
					<li><a href="../../Gem/Uninstaller.html">Gem::Uninstaller</a></li>
				
					<li><a href="../../Gem/UserInteraction.html">Gem::UserInteraction</a></li>
				
					<li><a href="../../Gem/Validator.html">Gem::Validator</a></li>
				
					<li><a href="../../Gem/VerificationError.html">Gem::VerificationError</a></li>
				
					<li><a href="../../Gem/Version.html">Gem::Version</a></li>
				
					<li><a href="../../Gem/VersionOption.html">Gem::VersionOption</a></li>
				
					<li><a href="../../OpenSSL.html">OpenSSL</a></li>
				
					<li><a href="../../OpenSSL/X509.html">OpenSSL::X509</a></li>
				
					<li><a href="../../GemGauntlet.html">GemGauntlet</a></li>
				
					<li><a href="../../Kernel.html">Kernel</a></li>
				
					<li><a href="../../Object.html">Object</a></li>
				
					<li><a href="../../TempIO.html">TempIO</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="class">Gem::Package::TarInput</h1>

		<div id="description">
			
		</div>

		<!-- Constants -->
		

		<!-- Attributes -->
		
		<div id="attribute-method-details" class="method-section section">
			<h3 class="section-header">Attributes</h3>

			
			<div id="metadata-attribute-method" class="method-detail">
				<a name="metadata"></a>
				
				<div class="method-heading attribute-method-heading">
					<span class="method-name">metadata</span><span
						class="attribute-access-type">[R]</span>
				</div>

				<div class="method-description">
				
				
				
				</div>
			</div>
			
		</div>
		

		<!-- Methods -->
		
		<div id="public-class-method-details" class="method-section section">
			<h3 class="section-header">Public Class Methods</h3>

		
			<div id="new-method" class="method-detail ">
				<a name="method-c-new"></a>

				<div class="method-heading">
				
					<span class="method-name">new</span><span
						class="method-args">(io, security_policy = nil)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="new-source">
<pre>
     <span class="ruby-comment cmt"># File lib/rubygems/package/tar_input.rb, line 27</span>
 27:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">io</span>, <span class="ruby-identifier">security_policy</span> = <span class="ruby-keyword kw">nil</span>)
 28:     <span class="ruby-ivar">@io</span> = <span class="ruby-identifier">io</span>
 29:     <span class="ruby-ivar">@tarreader</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Package</span><span class="ruby-operator">::</span><span class="ruby-constant">TarReader</span>.<span class="ruby-identifier">new</span> <span class="ruby-ivar">@io</span>
 30:     <span class="ruby-identifier">has_meta</span> = <span class="ruby-keyword kw">false</span>
 31: 
 32:     <span class="ruby-identifier">data_sig</span>, <span class="ruby-identifier">meta_sig</span>, <span class="ruby-identifier">data_dgst</span>, <span class="ruby-identifier">meta_dgst</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>
 33:     <span class="ruby-identifier">dgst_algo</span> = <span class="ruby-identifier">security_policy</span> <span class="ruby-operator">?</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Security</span><span class="ruby-operator">::</span><span class="ruby-constant">OPT</span>[<span class="ruby-value">:dgst_algo</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
 34: 
 35:     <span class="ruby-ivar">@tarreader</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entry</span><span class="ruby-operator">|</span>
 36:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">full_name</span>
 37:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;metadata&quot;</span>
 38:         <span class="ruby-ivar">@metadata</span> = <span class="ruby-identifier">load_gemspec</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">read</span>
 39:         <span class="ruby-identifier">has_meta</span> = <span class="ruby-keyword kw">true</span>
 40:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;metadata.gz&quot;</span>
 41:         <span class="ruby-keyword kw">begin</span>
 42:           <span class="ruby-comment cmt"># if we have a security_policy, then pre-read the metadata file</span>
 43:           <span class="ruby-comment cmt"># and calculate it's digest</span>
 44:           <span class="ruby-identifier">sio</span> = <span class="ruby-keyword kw">nil</span>
 45:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">security_policy</span>
 46:             <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">ensure_ssl_available</span>
 47:             <span class="ruby-identifier">sio</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">read</span>)
 48:             <span class="ruby-identifier">meta_dgst</span> = <span class="ruby-identifier">dgst_algo</span>.<span class="ruby-identifier">digest</span>(<span class="ruby-identifier">sio</span>.<span class="ruby-identifier">string</span>)
 49:             <span class="ruby-identifier">sio</span>.<span class="ruby-identifier">rewind</span>
 50:           <span class="ruby-keyword kw">end</span>
 51: 
 52:           <span class="ruby-identifier">gzis</span> = <span class="ruby-constant">Zlib</span><span class="ruby-operator">::</span><span class="ruby-constant">GzipReader</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">sio</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">entry</span>)
 53:           <span class="ruby-comment cmt"># YAML wants an instance of IO</span>
 54:           <span class="ruby-ivar">@metadata</span> = <span class="ruby-identifier">load_gemspec</span>(<span class="ruby-identifier">gzis</span>)
 55:           <span class="ruby-identifier">has_meta</span> = <span class="ruby-keyword kw">true</span>
 56:         <span class="ruby-keyword kw">ensure</span>
 57:           <span class="ruby-identifier">gzis</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">gzis</span>.<span class="ruby-identifier">nil?</span>
 58:         <span class="ruby-keyword kw">end</span>
 59:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'metadata.gz.sig'</span>
 60:         <span class="ruby-identifier">meta_sig</span> = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">read</span>
 61:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'data.tar.gz.sig'</span>
 62:         <span class="ruby-identifier">data_sig</span> = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">read</span>
 63:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'data.tar.gz'</span>
 64:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">security_policy</span>
 65:           <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">ensure_ssl_available</span>
 66:           <span class="ruby-identifier">data_dgst</span> = <span class="ruby-identifier">dgst_algo</span>.<span class="ruby-identifier">digest</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">read</span>)
 67:         <span class="ruby-keyword kw">end</span>
 68:       <span class="ruby-keyword kw">end</span>
 69:     <span class="ruby-keyword kw">end</span>
 70: 
 71:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">security_policy</span> <span class="ruby-keyword kw">then</span>
 72:       <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">ensure_ssl_available</span>
 73: 
 74:       <span class="ruby-comment cmt"># map trust policy from string to actual class (or a serialized YAML</span>
 75:       <span class="ruby-comment cmt"># file, if that exists)</span>
 76:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">String</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">security_policy</span> <span class="ruby-keyword kw">then</span>
 77:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Security</span><span class="ruby-operator">::</span><span class="ruby-constant">Policies</span>.<span class="ruby-identifier">key?</span> <span class="ruby-identifier">security_policy</span> <span class="ruby-keyword kw">then</span>
 78:           <span class="ruby-comment cmt"># load one of the pre-defined security policies</span>
 79:           <span class="ruby-identifier">security_policy</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Security</span><span class="ruby-operator">::</span><span class="ruby-constant">Policies</span>[<span class="ruby-identifier">security_policy</span>]
 80:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">security_policy</span> <span class="ruby-keyword kw">then</span>
 81:           <span class="ruby-comment cmt"># FIXME: this doesn't work yet</span>
 82:           <span class="ruby-identifier">security_policy</span> = <span class="ruby-constant">YAML</span>.<span class="ruby-identifier">load</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">security_policy</span>)
 83:         <span class="ruby-keyword kw">else</span>
 84:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Exception</span>, <span class="ruby-node">&quot;Unknown trust policy '#{security_policy}'&quot;</span>
 85:         <span class="ruby-keyword kw">end</span>
 86:       <span class="ruby-keyword kw">end</span>
 87: 
 88:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data_sig</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">data_dgst</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">meta_sig</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">meta_dgst</span> <span class="ruby-keyword kw">then</span>
 89:         <span class="ruby-comment cmt"># the user has a trust policy, and we have a signed gem</span>
 90:         <span class="ruby-comment cmt"># file, so use the trust policy to verify the gem signature</span>
 91: 
 92:         <span class="ruby-keyword kw">begin</span>
 93:           <span class="ruby-identifier">security_policy</span>.<span class="ruby-identifier">verify_gem</span>(<span class="ruby-identifier">data_sig</span>, <span class="ruby-identifier">data_dgst</span>, <span class="ruby-ivar">@metadata</span>.<span class="ruby-identifier">cert_chain</span>)
 94:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
 95:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Couldn't verify data signature: #{e}&quot;</span>
 96:         <span class="ruby-keyword kw">end</span>
 97: 
 98:         <span class="ruby-keyword kw">begin</span>
 99:           <span class="ruby-identifier">security_policy</span>.<span class="ruby-identifier">verify_gem</span>(<span class="ruby-identifier">meta_sig</span>, <span class="ruby-identifier">meta_dgst</span>, <span class="ruby-ivar">@metadata</span>.<span class="ruby-identifier">cert_chain</span>)
100:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
101:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Couldn't verify metadata signature: #{e}&quot;</span>
102:         <span class="ruby-keyword kw">end</span>
103:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">security_policy</span>.<span class="ruby-identifier">only_signed</span>
104:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Exception</span>, <span class="ruby-value str">&quot;Unsigned gem&quot;</span>
105:       <span class="ruby-keyword kw">else</span>
106:         <span class="ruby-comment cmt"># FIXME: should display warning here (trust policy, but</span>
107:         <span class="ruby-comment cmt"># either unsigned or badly signed gem file)</span>
108:       <span class="ruby-keyword kw">end</span>
109:     <span class="ruby-keyword kw">end</span>
110: 
111:     <span class="ruby-ivar">@tarreader</span>.<span class="ruby-identifier">rewind</span>
112:     <span class="ruby-ivar">@fileops</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">FileOperations</span>.<span class="ruby-identifier">new</span>
113: 
114:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">has_meta</span> <span class="ruby-keyword kw">then</span>
115:       <span class="ruby-identifier">path</span> = <span class="ruby-identifier">io</span>.<span class="ruby-identifier">path</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">io</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:path</span>
116:       <span class="ruby-identifier">error</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Package</span><span class="ruby-operator">::</span><span class="ruby-constant">FormatError</span>.<span class="ruby-identifier">new</span> <span class="ruby-value str">'no metadata found'</span>, <span class="ruby-identifier">path</span>
117:       <span class="ruby-identifier">raise</span> <span class="ruby-identifier">error</span>
118:     <span class="ruby-keyword kw">end</span>
119:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="open-method" class="method-detail ">
				<a name="method-c-open"></a>

				<div class="method-heading">
				
					<span class="method-name">open</span><span
						class="method-args">(io, security_policy = nil, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="open-source">
<pre>
    <span class="ruby-comment cmt"># File lib/rubygems/package/tar_input.rb, line 19</span>
19:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">io</span>, <span class="ruby-identifier">security_policy</span> = <span class="ruby-keyword kw">nil</span>,  &amp;<span class="ruby-identifier">block</span>)
20:     <span class="ruby-identifier">is</span> = <span class="ruby-identifier">new</span> <span class="ruby-identifier">io</span>, <span class="ruby-identifier">security_policy</span>
21: 
22:     <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">is</span>
23:   <span class="ruby-keyword kw">ensure</span>
24:     <span class="ruby-identifier">is</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is</span>
25:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="close-method" class="method-detail ">
				<a name="method-i-close"></a>

				<div class="method-heading">
				
					<span class="method-name">close</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="close-source">
<pre>
     <span class="ruby-comment cmt"># File lib/rubygems/package/tar_input.rb, line 121</span>
121:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">close</span>
122:     <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">close</span>
123:     <span class="ruby-ivar">@tarreader</span>.<span class="ruby-identifier">close</span>
124:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="each-method" class="method-detail ">
				<a name="method-i-each"></a>

				<div class="method-heading">
				
					<span class="method-name">each</span><span
						class="method-args">(&block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="each-source">
<pre>
     <span class="ruby-comment cmt"># File lib/rubygems/package/tar_input.rb, line 126</span>
126:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each</span>(&amp;<span class="ruby-identifier">block</span>)
127:     <span class="ruby-ivar">@tarreader</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entry</span><span class="ruby-operator">|</span>
128:       <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">full_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;data.tar.gz&quot;</span>
129:       <span class="ruby-identifier">is</span> = <span class="ruby-identifier">zipped_stream</span> <span class="ruby-identifier">entry</span>
130: 
131:       <span class="ruby-keyword kw">begin</span>
132:         <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Package</span><span class="ruby-operator">::</span><span class="ruby-constant">TarReader</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">is</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">inner</span><span class="ruby-operator">|</span>
133:           <span class="ruby-identifier">inner</span>.<span class="ruby-identifier">each</span>(&amp;<span class="ruby-identifier">block</span>)
134:         <span class="ruby-keyword kw">end</span>
135:       <span class="ruby-keyword kw">ensure</span>
136:         <span class="ruby-identifier">is</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is</span>
137:       <span class="ruby-keyword kw">end</span>
138:     <span class="ruby-keyword kw">end</span>
139: 
140:     <span class="ruby-ivar">@tarreader</span>.<span class="ruby-identifier">rewind</span>
141:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="extract-entry-method" class="method-detail ">
				<a name="method-i-extract_entry"></a>

				<div class="method-heading">
				
					<span class="method-name">extract_entry</span><span
						class="method-args">(destdir, entry, expected_md5sum = nil)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="extract-entry-source">
<pre>
     <span class="ruby-comment cmt"># File lib/rubygems/package/tar_input.rb, line 143</span>
143:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">extract_entry</span>(<span class="ruby-identifier">destdir</span>, <span class="ruby-identifier">entry</span>, <span class="ruby-identifier">expected_md5sum</span> = <span class="ruby-keyword kw">nil</span>)
144:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">directory?</span> <span class="ruby-keyword kw">then</span>
145:       <span class="ruby-identifier">dest</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">destdir</span>, <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">full_name</span>
146: 
147:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span> <span class="ruby-identifier">dest</span> <span class="ruby-keyword kw">then</span>
148:         <span class="ruby-ivar">@fileops</span>.<span class="ruby-identifier">chmod</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">header</span>.<span class="ruby-identifier">mode</span>, <span class="ruby-identifier">dest</span>, <span class="ruby-value">:verbose</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>
149:       <span class="ruby-keyword kw">else</span>
150:         <span class="ruby-ivar">@fileops</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-identifier">dest</span>, <span class="ruby-value">:mode</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">header</span>.<span class="ruby-identifier">mode</span>, <span class="ruby-value">:verbose</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>
151:       <span class="ruby-keyword kw">end</span>
152: 
153:       <span class="ruby-identifier">fsync_dir</span> <span class="ruby-identifier">dest</span>
154:       <span class="ruby-identifier">fsync_dir</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">dest</span>, <span class="ruby-value str">&quot;..&quot;</span>)
155: 
156:       <span class="ruby-keyword kw">return</span>
157:     <span class="ruby-keyword kw">end</span>
158: 
159:     <span class="ruby-comment cmt"># it's a file</span>
160:     <span class="ruby-identifier">md5</span> = <span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD5</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">expected_md5sum</span>
161:     <span class="ruby-identifier">destdir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">destdir</span>, <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">full_name</span>)
162:     <span class="ruby-ivar">@fileops</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-identifier">destdir</span>, <span class="ruby-value">:mode</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0755</span>, <span class="ruby-value">:verbose</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>
163:     <span class="ruby-identifier">destfile</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">destdir</span>, <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">full_name</span>)
164:     <span class="ruby-ivar">@fileops</span>.<span class="ruby-identifier">chmod</span> <span class="ruby-value">0600</span>, <span class="ruby-identifier">destfile</span>, <span class="ruby-value">:verbose</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-comment cmt"># Errno::ENOENT</span>
165: 
166:     <span class="ruby-identifier">open</span> <span class="ruby-identifier">destfile</span>, <span class="ruby-value str">&quot;wb&quot;</span>, <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">header</span>.<span class="ruby-identifier">mode</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">os</span><span class="ruby-operator">|</span>
167:       <span class="ruby-identifier">loop</span> <span class="ruby-keyword kw">do</span>
168:         <span class="ruby-identifier">data</span> = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">read</span> <span class="ruby-value">4096</span>
169:         <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">data</span>
170:         <span class="ruby-comment cmt"># HACK shouldn't we check the MD5 before writing to disk?</span>
171:         <span class="ruby-identifier">md5</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">data</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">expected_md5sum</span>
172:         <span class="ruby-identifier">os</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">data</span>)
173:       <span class="ruby-keyword kw">end</span>
174: 
175:       <span class="ruby-identifier">os</span>.<span class="ruby-identifier">fsync</span>
176:     <span class="ruby-keyword kw">end</span>
177: 
178:     <span class="ruby-ivar">@fileops</span>.<span class="ruby-identifier">chmod</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">header</span>.<span class="ruby-identifier">mode</span>, <span class="ruby-identifier">destfile</span>, <span class="ruby-value">:verbose</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>
179:     <span class="ruby-identifier">fsync_dir</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">destfile</span>)
180:     <span class="ruby-identifier">fsync_dir</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">destfile</span>), <span class="ruby-value str">&quot;..&quot;</span>)
181: 
182:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">expected_md5sum</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">expected_md5sum</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">md5</span>.<span class="ruby-identifier">hexdigest</span> <span class="ruby-keyword kw">then</span>
183:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Package</span><span class="ruby-operator">::</span><span class="ruby-constant">BadCheckSum</span>
184:     <span class="ruby-keyword kw">end</span>
185:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="load-gemspec-method" class="method-detail ">
				<a name="method-i-load_gemspec"></a>

				<div class="method-heading">
				
					<span class="method-name">load_gemspec</span><span
						class="method-args">(io)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Attempt to YAML-load a gemspec from the given <em>io</em> parameter. 
Return nil if it fails.
</p>
					

					
					<div class="method-source-code"
						id="load-gemspec-source">
<pre>
     <span class="ruby-comment cmt"># File lib/rubygems/package/tar_input.rb, line 189</span>
189:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_gemspec</span>(<span class="ruby-identifier">io</span>)
190:     <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">from_yaml</span> <span class="ruby-identifier">io</span>
191:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Exception</span>
192:     <span class="ruby-keyword kw">nil</span>
193:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="zipped-stream-method" class="method-detail ">
				<a name="method-i-zipped_stream"></a>

				<div class="method-heading">
				
					<span class="method-name">zipped_stream</span><span
						class="method-args">(entry)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Return an IO stream for the zipped entry.
</p>
<p>
NOTE:  Originally this method used two approaches, Return a GZipReader
directly, or read the GZipReader into a string and return a StringIO on the
string.  The string IO approach was used for versions of ZLib before 1.2.1
to avoid buffer errors on windows machines.  Then we found that errors
happened with 1.2.1 as well, so we changed the condition.  Then we
discovered errors occurred with versions as late as 1.2.3.  At this point
(after some benchmarking to show we weren&#8217;t seriously crippling the
unpacking speed) we threw our hands in the air and declared that this
method would use the String IO approach on all platforms at all times.  And
that&#8217;s the way it is.
</p>
					

					
					<div class="method-source-code"
						id="zipped-stream-source">
<pre>
     <span class="ruby-comment cmt"># File lib/rubygems/package/tar_input.rb, line 209</span>
209:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">zipped_stream</span>(<span class="ruby-identifier">entry</span>)
210:     <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">defined?</span> <span class="ruby-constant">Rubinius</span> <span class="ruby-keyword kw">or</span> <span class="ruby-keyword kw">defined?</span> <span class="ruby-constant">Maglev</span> <span class="ruby-keyword kw">then</span>
211:       <span class="ruby-comment cmt"># these implementations have working Zlib</span>
212:       <span class="ruby-identifier">zis</span> = <span class="ruby-constant">Zlib</span><span class="ruby-operator">::</span><span class="ruby-constant">GzipReader</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">entry</span>
213:       <span class="ruby-identifier">dis</span> = <span class="ruby-identifier">zis</span>.<span class="ruby-identifier">read</span>
214:       <span class="ruby-identifier">is</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">dis</span>)
215:     <span class="ruby-keyword kw">else</span>
216:       <span class="ruby-comment cmt"># This is Jamis Buck's Zlib workaround for some unknown issue</span>
217:       <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value">10</span>) <span class="ruby-comment cmt"># skip the gzip header</span>
218:       <span class="ruby-identifier">zis</span> = <span class="ruby-constant">Zlib</span><span class="ruby-operator">::</span><span class="ruby-constant">Inflate</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">-</span><span class="ruby-constant">Zlib</span><span class="ruby-operator">::</span><span class="ruby-constant">MAX_WBITS</span>)
219:       <span class="ruby-identifier">is</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">zis</span>.<span class="ruby-identifier">inflate</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">read</span>))
220:     <span class="ruby-keyword kw">end</span>
221:   <span class="ruby-keyword kw">ensure</span>
222:     <span class="ruby-identifier">zis</span>.<span class="ruby-identifier">finish</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">zis</span>
223:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

